{{- if ne .hosttype "hpc" }}
Host *
{{- if eq .chezmoi.os "darwin" }}
    IdentityAgent "~/Library/Group Containers/2BUA8C4S2C.com.1password/t/agent.sock"
{{- else }}
    IdentityAgent "~/.1password/agent.sock"
{{- end }}
{{- end }}
{{ range $name, $host := .hosts -}}
{{ if ne $name $.chezmoi.hostname }}
Host {{ $name }}
    HostName {{ if hasKey $host "ssh_host" }}{{ $host.ssh_host }}{{ else }}{{ $name }}{{ end }}
    User {{ $host.user }}
{{- if and (hasKey $host "is_hpc") $host.is_hpc }}
    ForwardAgent yes
{{- end }}
{{ end -}}
{{ end -}}
